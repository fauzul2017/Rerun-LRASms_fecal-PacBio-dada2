### During re-run of the tutorial provided on https://benjjneb.github.io/LRASManuscript/LRASms_fecal.html, i have found one small error in the ordination step. Here, i have used bold font and red font to show the code and there repalcement code is shown in green colour##############

library(dada2)
library(Biostrings)
library(ShortRead)
library(ggplot2)
library(reshape2)
library(RColorBrewer)
library(gridExtra)
library('phyloseq')


st2 <- readRDS(file.path("/Users/DELL/Desktop/LRASManuscript-master/LRASManuscript-master/RDS/", "Fecal_st2.rds"))
tax2 <- readRDS(file.path("/Users/DELL/Desktop/LRASManuscript-master/LRASManuscript-master/RDS/", "Fecal_tax2_Silva128.rds"))
#Import the metadata for these samples, which is just the #subject and the time ordering of the sample from that subject #(only relevant for the two subjects with multiple samples).
ft2 <- sweep(st2, 1, rowSums(st2), "/")
df <- read.table("/Users/DELL/Desktop/LRASManuscript-master/LRASManuscript-master/Docs/Fecal_Metadata.csv", header=TRUE, sep="\t", stringsAsFactors=FALSE)
df$SampleID <- gsub("_", ".", df$X)
df$SampleID <- gsub("^D", "D_", df$SampleID)
df$SampleID <- gsub("^R", "R_", df$SampleID)

#Create an ordination.
ps2 <- phyloseq(otu_table(ft2, taxa_are_rows=FALSE), sample_names(df))
ord2 <- ordinate(ps2, method="MDS", distance="bray")
#dford2 <- cbind(df, ord2$vectors)
#Error in data.frame(..., check.names = FALSE) : 
#  arguments imply differing number of rows: 12, 9
dford2 <- cbind(df[c(12, 1, 3, 4, 5, 7, 9, 10 , 11),], ord2$vectors) 
ggplot(data=dford2, aes(x=Axis.1, y=Axis.2, color=Subject)) + geom_text(aes(label=SampleID))
